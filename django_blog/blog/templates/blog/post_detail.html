{% extends "base.html" %}
{% block content %}
<div class="container" style="max-width: 800px;">
    <article style="background: #1e293b; padding: 40px; border-radius: 10px; border: 1px solid #334155;">
        <h1 style="font-size: 2.5em; margin-bottom: 10px;">{{ object.title }}</h1>
        <div
            style="font-size: 0.9em; color: #94a3b8; margin-bottom: 30px; border-bottom: 1px solid #334155; padding-bottom: 20px;">
            By <span style="color: #a855f7;">{{ object.author }}</span> | {{ object.published_date|date:"F d, Y" }}
        </div>

        <div style="line-height: 1.8; font-size: 1.1em;">
            {{ object.content|linebreaks }}
        </div>

        {% if object.author == user %}
        <div style="margin-top: 40px; border-top: 1px solid #334155; padding-top: 20px;">
            <a href="{% url 'post-update' object.pk %}" class="btn-register"
                style="text-decoration: none; display: inline-block; margin-right: 10px;">Edit Post</a>
            <a href="{% url 'post-delete' object.pk %}"
                style="color: #ef4444; text-decoration: none; font-weight: bold;">Delete Post</a>
        </div>
        {% endif %}
        <div style="margin-top: 40px; border-top: 1px solid #334155; padding-top: 20px;">
            <h3>Comments ({{ object.comments.count }})</h3>

            {% if user.is_authenticated %}
            <a href="{% url 'comment-create' object.pk %}" class="btn-register"
                style="display: inline-block; margin: 15px 0; text-decoration: none;">Add a Comment</a>
            {% else %}
            <p><a href="{% url 'login' %}" style="color: #a855f7;">Login</a> to leave a comment.</p>
            {% endif %}

            <div class="comments-list">
                {% for comment in object.comments.all %}
                <div
                    style="background: #0f172a; padding: 15px; margin-bottom: 15px; border-radius: 8px; border: 1px solid #334155;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <strong style="color: #e2e8f0;">{{ comment.author }}</strong>
                        <small style="color: #94a3b8;">{{ comment.created_at|date:"M d, Y H:i" }}</small>
                    </div>
                    <p style="color: #cbd5e1;">{{ comment.content }}</p>

                    {% if comment.author == user %}
                    <div style="margin-top: 10px; font-size: 0.85em;">
                        <a href="{% url 'comment-update' comment.pk %}"
                            style="color: #a855f7; margin-right: 10px; text-decoration: none;">Edit</a>
                        <a href="{% url 'comment-delete' comment.pk %}"
                            style="color: #ef4444; text-decoration: none;">Delete</a>
                    </div>
                    {% endif %}
                </div>
                {% empty %}
                <p style="color: #94a3b8; font-style: italic;">No comments yet. Be the first!</p>
                {% endfor %}
            </div>
        </div>
    </article>
</div>
{% endblock %}